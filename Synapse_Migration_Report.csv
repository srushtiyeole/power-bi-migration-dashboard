Table Name,Server,Database,SQL Query
All Suspended,dta-eun-prod-sqlsrv-synapse-01.database.windows.net,dta-eun-prod-datawarehouse-synapse-01,"select a.request_id,((total_elapsed_time%(1000*60*60))%(1000*60))/1000 as wait_sec,b.login_name,a.importance,a.classifier_name from sys.dm_pdw_exec_requests a inner join sys.dm_pdw_exec_sessions  b on a.session_id=b.session_id where a.status in ('Suspended')"
All_Running,dta-eun-prod-sqlsrv-synapse-01.database.windows.net,dta-eun-prod-datawarehouse-synapse-01,"SELECT      login_name,     a.request_id,     total_elapsed_time / (1000 * 60) AS Minutes,     resource_class,     importance,     group_name,     resource_allocation_percentage,     result_cache_hit,     app_name,     command,     'KILL ''' + CAST(a.session_id AS VARCHAR(20)) + '''' AS kill_command #(tab),a.status FROM      sys.dm_pdw_exec_requests a INNER JOIN      sys.dm_pdw_exec_sessions b ON      a.session_id = b.session_id WHERE      a.status IN ('running')     AND a.resource_class IS NOT NULL;"
All_Running_2,dta-eun-prod-sqlsrv-synapse-01.database.windows.net,dta-eun-prod-datawarehouse-synapse-01,"select login_name,a.request_id,(total_elapsed_time%(1000*60*60))/(1000*60)as Minutes,resource_class,importance,group_name,resource_allocation_percentage,result_cache_hit,app_name, case when command2 is null then command else command2 end command   from sys.dm_pdw_exec_requests a   inner join sys.dm_pdw_exec_sessions  b   on a.session_id=b.session_id   where a.status in ('running')   and a.resource_class is not null"
OpenSessions,dta-eun-prod-sqlsrv-synapse-01.database.windows.net,dta-eun-prod-datawarehouse-synapse-01,"select  * from sys.dm_pdw_exec_sessions where status in ('Idle','Active')"
request_steps,dta-eun-prod-sqlsrv-synapse-01.database.windows.net,dta-eun-prod-datawarehouse-synapse-01,SELECT * FROM sys.dm_pdw_request_steps
